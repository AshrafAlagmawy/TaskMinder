<section class="bg-main-light shadow p-2 my-5 p-3 rounded-4 w-50 m-auto">
  <div>
    <div class="logo p-3 d-flex justify-content-center align-items-center gap-2 mb-3">
      <img src="/assets/icons/Rectangle 11 (Stroke).png" alt="TaskMinder Logo" />
      <span class="fs-5 fw-semibold">TaskMinder.</span>
    </div>
    <h2 class="text-center text-2xl font-semibold text-indigo-600 mb-6">Register</h2>
  </div>

  <form action="" [formGroup]="registerForm" (ngSubmit)="registerSubmit()">
    <div class="my-3">
      <label for="name" class="mb-2">Name</label>
      <input
        [ngClass]="{
          'is-valid':
            !registerForm.get('name')?.errors && (
              registerForm.get('name')?.touched || registerForm.get('name')?.dirty
            ),
          'is-invalid':
            registerForm.get('name')?.errors && (
              registerForm.get('name')?.touched || registerForm.get('name')?.dirty
            ),
        }"
        placeholder="Enter Your Name"
        type="text"
        class="form-control"
        id="name"
        formControlName="name"
      />
      @if(isFieldValid("name")){
      <div class="alert alert-danger w-auto m-2 p-2">
        @if(hasError("name","required")){
        <p class="m-0">Name is required</p>
        }@else if(hasError("name","minlength")){
        <p class="m-0">Name must be greater than 3 characters</p>
        } @else if(hasError("name","maxlength")){
        <p class="m-0">Name must be less than 30 characters</p>
        }
      </div>
      }
    </div>

    <div class="my-3">
      <label for="email" class="mb-2">Email</label>
      <input
        [ngClass]="{
          'is-valid':
            !registerForm.get('email')?.errors && (
              registerForm.get('email')?.touched || registerForm.get('email')?.dirty
            ),
          'is-invalid':
            registerForm.get('email')?.errors && (
              registerForm.get('email')?.touched || registerForm.get('email')?.dirty
            ),
        }"
        placeholder="Enter Your Email"
        type="email"
        class="form-control"
        id="email"
        formControlName="email"
      />
      @if(isFieldValid("email")){
      <div class="alert alert-danger w-auto m-2 p-2">
        @if(hasError("email","required")){
        <p class="m-0">Email is required</p>
        }@else if(hasError("email","email")){
        <p class="m-0">Email valid email</p>
        }
      </div>
      }
    </div>

    <div class="my-3">
      <label for="phone" class="mb-2">Phone Number</label>
      <input
        [ngClass]="{
          'is-valid':
            !registerForm.get('phone')?.errors && (
              registerForm.get('phone')?.touched || registerForm.get('phone')?.dirty
            ),
          'is-invalid':
            registerForm.get('phone')?.errors && (
              registerForm.get('phone')?.touched || registerForm.get('phone')?.dirty
            ),
        }"
        placeholder="Enter Your Phone Number"
        type="tel"
        class="form-control"
        id="phone"
        formControlName="phone"
      />
      @if(isFieldValid("phone")){
      <div class="alert alert-danger w-auto m-2 p-2">
        @if(hasError("phone","required")){
        <p class="m-0">Phone Number is required</p>
        } @else if(hasError("phone","pattern")){
        <p class="m-0">Enter valid phone number</p>
        }
      </div>
      }
    </div>

    <div class="my-3">
      <label for="password" class="mb-2">Password</label>
      <input
        [ngClass]="{
          'is-valid':
            !registerForm.get('password')?.errors && (
              registerForm.get('password')?.touched || registerForm.get('password')?.dirty
            ),
          'is-invalid':
            registerForm.get('password')?.errors && (
              registerForm.get('password')?.touched || registerForm.get('password')?.dirty
            ),
        }"
        placeholder="Enter Your Password"
        type="password"
        class="form-control"
        id="password"
        formControlName="password"
      />
      @if(isFieldValid("password")){
      <div class="alert alert-danger w-auto m-2 p-2">
        @if(hasError("password","required")){
        <p class="m-0">Password is required</p>
        }@else if(hasError("password","pattern")){
        <p class="m-0">Enter valid password</p>
        }
      </div>
      }
    </div>

    <div class="my-3">
      <label for="rePassword" class="mb-2">Confirm Password</label>
      <input
        [ngClass]="{
          'is-valid':
            !registerForm.get('rePassword')?.errors && (
              registerForm.get('rePassword')?.touched || registerForm.get('rePassword')?.dirty
            ),
          'is-invalid':
            registerForm.get('rePassword')?.errors && (
              registerForm.get('rePassword')?.touched || registerForm.get('rePassword')?.dirty
            ),
        }"
        placeholder="Enter Your Password Again For Confirmation"
        type="password"
        class="form-control"
        id="rePassword"
        formControlName="rePassword"
      />
      @if(registerForm.getError('mismatch')&&registerForm.get("rePassword")?.touched){
      <p class="m-0">Password confirmations is incorrect</p>
      }
    </div>

    <div class="d-flex justify-content-end ms-auto gap-2">
      <button routerLink="/login" type="button" class="btn d-block">Login</button>

      <button [disabled]="registerForm.invalid || isLoading" type="submit" class="btn d-block">
        Register @if(isLoading){
        <span><i class="fas fa-spin fa-spinner"></i></span>
        }
      </button>
    </div>
    @if(msgError){
    <p class="text-red-600 m-0">{{ msgError }}</p>
    } @if(msgSuccess){
    <p class="text-green-600 m-0">Login Success</p>
    }
  </form>
</section>
